<?php

class Test_Kirki_Styles_Customizer extends WP_UnitTestCase {

	public function test_google_font_enqueued() {
		Kirki();
		do_action( 'customize_controls_print_styles' );
		$styles = $GLOBALS['wp_styles']->registered;
		$this->assertTrue( isset( $styles['kirki-customizer-css'] ) );
	}

	public function test_custom_css() {
		add_filter( 'kirki/config', function( $config ) {
			$config['logo_image']   = 'http://kirki.org/img/kirki-new-logo-white.png';
			$config['description']  = __( 'The theme description.', 'kirki' );
			$config['color_accent'] = '#00bcd4';
			$config['color_back']   = '#455a64';
			$config['width']        = '20%';
			return $config;
		});

		Kirki();
		do_action( 'customize_controls_print_styles' );
		$styles = $GLOBALS['wp_styles']->registered;
		$this->assertEquals(
			'.wp-core-ui .button-primary-disabled, .wp-core-ui .button-primary.disabled, .wp-core-ui .button-primary:disabled, .wp-core-ui .button-primary[disabled]{background:#3498DB !important;color:#fff !important;border-color:rgba(0,0,0,.1) !important;opacity:.7;}.wp-core-ui .button-primary{background-color:#3498DB;color:#fff;opacity:1;}#customize-controls .customize-info .customize-help-toggle{color:#3498DB;}.customize-control-radio-image .image.ui-buttonset label.ui-state-active{border:2px solid #3498DB;}.customize-control-radio-buttonset label.ui-state-active{background-color:#3498DB;color:#fff;;}.customize-control-slider .ui-slider .ui-slider-handle{background-color:#3498DB;}.customize-control-switch .Switch .On, .customize-control-toggle .Switch .On{color:#3498DB;}.customize-control-switch .Switch.Round.On, .customize-control-toggle .Switch.Round.On{background:#3498DB;}.customize-control-sortable ul.ui-sortable li .dashicons.visibility{color:#3498DB;}.customize-control-palette label.ui-state-active.ui-button.ui-widget span.ui-button-text{border-color:#3498DB;}',
			$styles['kirki-customizer-css']->extra['after'][0]
		);
		$this->assertEquals(
			'.wp-core-ui .button-primary-disabled, .wp-core-ui .button-primary.disabled, .wp-core-ui .button-primary:disabled, .wp-core-ui .button-primary[disabled]{background:#3498DB !important;color:#fff !important;border-color:rgba(0,0,0,.1) !important;opacity:.7;}.wp-core-ui .button-primary{background-color:#3498DB;color:#fff;opacity:1;}#customize-controls .customize-info .customize-help-toggle{color:#3498DB;}.customize-control-radio-image .image.ui-buttonset label.ui-state-active{border:2px solid #3498DB;}.customize-control-radio-buttonset label.ui-state-active{background-color:#3498DB;color:#fff;;}.customize-control-slider .ui-slider .ui-slider-handle{background-color:#3498DB;}.customize-control-switch .Switch .On, .customize-control-toggle .Switch .On{color:#3498DB;}.customize-control-switch .Switch.Round.On, .customize-control-toggle .Switch.Round.On{background:#3498DB;}.customize-control-sortable ul.ui-sortable li .dashicons.visibility{color:#3498DB;}.customize-control-palette label.ui-state-active.ui-button.ui-widget span.ui-button-text{border-color:#3498DB;}',
			$styles['kirki-customizer-css']->extra['after'][1]
		);
		$this->assertEquals(
			'.wp-full-overlay-sidebar{width:20%;}.wp-full-overlay.expanded{margin-left:20%;}.wp-full-overlay-sidebar{background:#455a64;}#customize-controls .customize-info .accordion-section-title, #customize-controls .panel-meta.customize-info .accordion-section-title:hover{background:#455a64;}#customize-controls .customize-info{border-top-color:rgba(255,255,255,.2);border-bottom-color:rgba(255,255,255,.2);}.customize-section-title{border-bottom-color:rgba(255,255,255,.2);}.customize-panel-back, .customize-section-back{border-right-color:rgba(255,255,255,.2);}#customize-header-actions{border-bottom-color:rgba(255,255,255,.2);}.customize-controls-close, .customize-overlay-close{border-right-color:rgba(255,255,255,.2)!important;}.customize-panel-back:focus, .customize-panel-back:hover, .customize-section-back:focus, .customize-section-back:hover, .customize-panel-back, .customize-section-back, .customize-controls-close, .customize-overlay-close{background:#95aab4;}.control-panel-back:focus, .control-panel-back:hover, .customize-controls-close:focus, .customize-controls-close:hover, .customize-controls-preview-toggle:focus, .customize-controls-preview-toggle:hover, .customize-overlay-close:focus, .customize-overlay-close:hover{background:#95aab4}#customize-theme-controls .accordion-section-title{background:#455a64;color:#f2f2f2;}#customize-controls .control-section .accordion-section-title:focus, #customize-controls .control-section .accordion-section-title:hover, #customize-controls .control-section.open .accordion-section-title, #customize-controls .control-section:hover>.accordion-section-title{background:#00bcd4;color:#ffffff;}.accordion-section-title:after, .handlediv, .item-edit, .sidebar-name-arrow, .widget-action{color:#bdd2dc}#customize-theme-controls .control-section .accordion-section-title:focus:after, #customize-theme-controls .control-section .accordion-section-title:hover:after, #customize-theme-controls .control-section.open .accordion-section-title:after, #customize-theme-controls .control-section:hover>.accordion-section-title:after{color:#78ffff}.customize-section-title{background:#455a64;}.customize-section-title h3, h3.customize-section-title{color:#f2f2f2;}#customize-theme-controls .accordion-section-content{background:#eceeef;}#customize-controls .customize-info .preview-notice{color:#f2f2f2;}.wp-core-ui .button-primary-disabled, .wp-core-ui .button-primary.disabled, .wp-core-ui .button-primary:disabled, .wp-core-ui .button-primary[disabled]{background:#00bcd4 !important;color:#fff !important;border-color:rgba(0,0,0,.1) !important;opacity:.7;}.wp-core-ui .button-primary{background-color:#00bcd4;color:#fff;opacity:1;}#customize-controls .customize-info .customize-help-toggle{color:#00bcd4;}.customize-control-radio-image .image.ui-buttonset label.ui-state-active{border:2px solid #00bcd4;}.customize-control-radio-buttonset label.ui-state-active{background-color:#00bcd4;color:#fff;;}.customize-control-slider .ui-slider .ui-slider-handle{background-color:#00bcd4;}.customize-control-switch .Switch .On, .customize-control-toggle .Switch .On{color:#00bcd4;}.customize-control-switch .Switch.Round.On, .customize-control-toggle .Switch.Round.On{background:#00bcd4;}.customize-control-sortable ul.ui-sortable li .dashicons.visibility{color:#00bcd4;}.customize-control-palette label.ui-state-active.ui-button.ui-widget span.ui-button-text{border-color:#00bcd4;}',
			$styles['kirki-customizer-css']->extra['after'][2]
		);
		$this->assertEquals(
			'.wp-full-overlay-sidebar{width:20%;}.wp-full-overlay.expanded{margin-left:20%;}.wp-full-overlay-sidebar{background:#455a64;}#customize-controls .customize-info .accordion-section-title, #customize-controls .panel-meta.customize-info .accordion-section-title:hover{background:#455a64;}#customize-controls .customize-info{border-top-color:rgba(255,255,255,.2);border-bottom-color:rgba(255,255,255,.2);}.customize-section-title{border-bottom-color:rgba(255,255,255,.2);}.customize-panel-back, .customize-section-back{border-right-color:rgba(255,255,255,.2);}#customize-header-actions{border-bottom-color:rgba(255,255,255,.2);}.customize-controls-close, .customize-overlay-close{border-right-color:rgba(255,255,255,.2)!important;}.customize-panel-back:focus, .customize-panel-back:hover, .customize-section-back:focus, .customize-section-back:hover, .customize-panel-back, .customize-section-back, .customize-controls-close, .customize-overlay-close{background:#95aab4;}.control-panel-back:focus, .control-panel-back:hover, .customize-controls-close:focus, .customize-controls-close:hover, .customize-controls-preview-toggle:focus, .customize-controls-preview-toggle:hover, .customize-overlay-close:focus, .customize-overlay-close:hover{background:#95aab4}#customize-theme-controls .accordion-section-title{background:#455a64;color:#f2f2f2;}#customize-controls .control-section .accordion-section-title:focus, #customize-controls .control-section .accordion-section-title:hover, #customize-controls .control-section.open .accordion-section-title, #customize-controls .control-section:hover>.accordion-section-title{background:#00bcd4;color:#ffffff;}.accordion-section-title:after, .handlediv, .item-edit, .sidebar-name-arrow, .widget-action{color:#bdd2dc}#customize-theme-controls .control-section .accordion-section-title:focus:after, #customize-theme-controls .control-section .accordion-section-title:hover:after, #customize-theme-controls .control-section.open .accordion-section-title:after, #customize-theme-controls .control-section:hover>.accordion-section-title:after{color:#78ffff}.customize-section-title{background:#455a64;}.customize-section-title h3, h3.customize-section-title{color:#f2f2f2;}#customize-theme-controls .accordion-section-content{background:#eceeef;}#customize-controls .customize-info .preview-notice{color:#f2f2f2;}.wp-core-ui .button-primary-disabled, .wp-core-ui .button-primary.disabled, .wp-core-ui .button-primary:disabled, .wp-core-ui .button-primary[disabled]{background:#00bcd4 !important;color:#fff !important;border-color:rgba(0,0,0,.1) !important;opacity:.7;}.wp-core-ui .button-primary{background-color:#00bcd4;color:#fff;opacity:1;}#customize-controls .customize-info .customize-help-toggle{color:#00bcd4;}.customize-control-radio-image .image.ui-buttonset label.ui-state-active{border:2px solid #00bcd4;}.customize-control-radio-buttonset label.ui-state-active{background-color:#00bcd4;color:#fff;;}.customize-control-slider .ui-slider .ui-slider-handle{background-color:#00bcd4;}.customize-control-switch .Switch .On, .customize-control-toggle .Switch .On{color:#00bcd4;}.customize-control-switch .Switch.Round.On, .customize-control-toggle .Switch.Round.On{background:#00bcd4;}.customize-control-sortable ul.ui-sortable li .dashicons.visibility{color:#00bcd4;}.customize-control-palette label.ui-state-active.ui-button.ui-widget span.ui-button-text{border-color:#00bcd4;}',
			$styles['kirki-customizer-css']->extra['after'][3]
		);
	}

}
